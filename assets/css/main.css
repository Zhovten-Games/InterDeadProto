@import url('https://fonts.cdnfonts.com/css/kahless'); /* font-family: 'Kahless', sans-serif; */
@import url('https://fonts.cdnfonts.com/css/unscreen-mk'); /* font-family: 'Unscreen', sans-serif; */
@import url('https://fonts.cdnfonts.com/css/calling-code'); /* font-family: 'Calling Code', sans-serif; */
/* Consolidated styles from hugr.css and reset.css */

:root {
  --bg-base:                    #001501; /* фон */
  --grid-line:                  rgba(0, 42, 2, 0.5); /* цвет сетки */
  --scanline-color:             rgba(0, 42, 2, 0.6); /* цвет тонких скан-строк */
  --grad-from:                  #6FD67C;
  --grad-mid:                   #8AE590;
  --grad-to:                    #6FD67C;
  --accent-color:               var(--grad-mid);
  --text-color:                 var(--grad-mid);
  --border:                     var(--accent-color);
  --fg:                         var(--text-color);
  --fg2:                        var(--text-color);
  --bg:                         transparent;
  --border-width:               8px;
  --project-frame-color:        rgba(102, 255, 102, .8);
  --project-glow-color:         rgba(102, 255, 102, .8);
  --glow-spread:                8px;
  --button-radius:              0px;
  --avatar-border-width:        1px;
  /* размеры */
  --content-max-width:          800px;
  --panel-width:                min(100%, var(--content-max-width));
  --panel-height:               180px;
  --panel-height-collapsed:     var(--bottom-area-height);
  --panel-padding:              16px;
  --bottom-area-height:         60px;
  --icon-size:                  40px;
  --frame-width:                4px;
  --frame-gap:                  8px;
  /* смещение круга от верха */
  --circle-offset:              16px;
  /* диаметр круга = 2×высота панели */
  --circle-diameter:            calc(var(--panel-height) - calc(var(--frame-width) + var(--circle-offset)));
  /*  скорость вращения колеса (360° за это время) */
  --rotation-duration:          40s;
  /* отступы и ширина нижней панели */
  --bottom-panel-base-offset:   0px;
  --bottom-panel-vertical-offset: 0px;
  --bottom-panel-extra-offset:  0px;
  --bottom-panel-width:         min(100%, var(--content-max-width));
  /* размер эмоджи */
  --emoji-size: 32px;
  /* сколько ячеек должно помещаться по ширине экрана */
  --cells-per-row: 10;
  /* размер одной ячейки = 100% ширины / количество */
  --cell-size: calc(100vw / var(--cells-per-row));
  /* параметры экранных полос */
  --stripe-color:    rgba(102, 255, 102, 0.02);
  --stripe-height:   2px;
  --stripe-spacing:  10px;
  /* длительность цикла анимации */
  --stripe-duration: 12s;
  /* базовый масштаб шрифта относительно высоты кнопки (или панели) */
  --btn-font-scale:  0.4;
  /* минимальный и максимальный размер шрифта */
  --btn-font-min:    1rem;
  --btn-font-max:    2.5rem;
  /* вычисляемый размер шрифта с ограничениями */
  --btn-font-size:   clamp(
                      var(--btn-font-min),
                      calc(var(--bottom-area-height) * var(--btn-font-scale)),
                      var(--btn-font-max)
                    );
  /* универсальные цвета кнопок */
  --btn-text-color: var(--text-color);
  --btn-font-family: 'Calling Code', sans-serif;
  --btn-font-weight: bold;
  --btn-letter-spacing: 0.1em;
}

    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0; padding: 0;
    }

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

button {
  background: transparent;
  border-radius: var(--button-radius);
  color: var(--text-color);
}

/* Unified scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--grad-mid) rgba(0, 20, 8, 0.45);
}

*::-webkit-scrollbar {
  width: 10px;
}

*::-webkit-scrollbar-track {
  background: rgba(0, 20, 8, 0.45);
}

*::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--grad-from), var(--grad-mid));
  border-radius: 12px;
  border: 1px solid rgba(0, 60, 20, 0.8);
}

    body {
      position: relative;
      background-color: var(--bg-base);
      background-image:
        radial-gradient(circle at top left, rgba(0, 0, 0, 0.6) 0%, transparent 40%),
        radial-gradient(circle at top right, rgba(0, 0, 0, 0.6) 0%, transparent 40%),
        radial-gradient(circle at bottom right, rgba(0, 0, 0, 0.6) 0%, transparent 40%),
        radial-gradient(circle at bottom left, rgba(0, 0, 0, 0.6) 0%, transparent 40%);
      background-repeat: no-repeat;
      background-size: cover;
      min-height: 100vh;
      font-family: 'Calling Code', sans-serif;
      color: var(--text-color);
    }

    body::after {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background: repeating-linear-gradient(
      var(--scanline-color) 0,
      var(--scanline-color) 1px,
      transparent 1px,
      transparent 4px
    );
      background-size: 32px 32px, 32px 32px, 100% 4px;
      mix-blend-mode: difference;
      /* Две анимации сразу:
         1) движение: вниз-подъём-вниз
         2) затухание */
      /*animation: 
        stripe-move var(--stripe-duration) ease-in-out infinite,
        stripe-fade var(--stripe-duration) ease-in-out infinite;*/
      z-index: 999;
    }

    /* движемся вниз к stripe-spacing, затем обратно */
    @keyframes stripe-move {
      0%   { background-position-y: 0; }
      50%  { background-position-y: var(--stripe-spacing); }
      100% { background-position-y: 0; }
    }

    /* плавное затухание до 30% прозрачности и обратно */
    @keyframes stripe-fade {
      0%, 100%  { opacity: 0.3; }
      50%       { opacity: 0.6; }
    }

    body::before {
      /* тёмный виньет */
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(circle at top left,     rgba(0,0,0,0.6) 0%, rgba(0,0,0,0) 40%),
        radial-gradient(circle at top right,    rgba(0,0,0,0.6) 0%, rgba(0,0,0,0) 40%),
        radial-gradient(circle at bottom right, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0) 40%),
        radial-gradient(circle at bottom left,  rgba(0,0,0,0.6) 0%, rgba(0,0,0,0) 40%);
      z-index: 1;
    }

    /* Loader overlay covering the full screen */
    .loader,
    .app__loader {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 3rem 1.5rem;
      background: rgba(0, 0, 0, 0.86);
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      transition: opacity 0.4s ease, visibility 0.4s ease;
      z-index: 1200;
    }

    .loader::before,
    .app__loader::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image:
        repeating-linear-gradient(
          90deg,
          var(--grid-line) 0,
          var(--grid-line) 1px,
          transparent 1px,
          transparent var(--cell-size)
        ),
        repeating-linear-gradient(
          var(--grid-line) 0,
          var(--grid-line) 1px,
          transparent 1px,
          transparent var(--cell-size)
        );
      background-size:
        var(--cell-size) var(--cell-size),
        var(--cell-size) var(--cell-size);
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    /* Visible state */
    .loader--visible,
    .app__loader--visible {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }

    .loader--visible::before,
    .app__loader--visible::before {
      opacity: 1;
    }

    .loader__content {
      position: relative;
      z-index: 1;
      width: min(640px, 100%);
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      text-align: center;
    }

    .loader__message {
      font-size: clamp(1.125rem, 2vw, 1.5rem);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #b5ffd0;
    }

    .loader__list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      align-items: center;
    }

    .loader__step {
      min-width: min(420px, 100%);
      padding: 0.75rem 1.5rem;
      background: rgba(0, 21, 1, 0.7);
      border: 1px solid rgba(111, 214, 124, 0.55);
      border-radius: 999px;
      box-shadow: 0 0 22px rgba(111, 214, 124, 0.25);
      overflow: hidden;
    }

    .loader__step-text {
      display: block;
      font-size: 1rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--text-color);
      text-align: center;
      white-space: nowrap;
    }

/* Dialog widget */
.dialog {
  padding: 18px 26px 0 26px;
  display: flex;
  flex-direction: column-reverse;
  gap: 15px;
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: var(--fg2) var(--bg);
}

.dialog__message {
  display: flex;
  align-items: flex-start;
  min-width: 50%;
  max-width: 90%;
  padding: 12px 16px 14px 16px;
  background: transparent;
  border: none;
  border-radius: 0;
  box-shadow: none;
  color: var(--text-color);
  font-size: 1.24em;
  position: relative;
  list-style: none;
}

.dialog__avatar {
  width: 32px;
  height: 32px;
  border-radius: 0;
  border: var(--avatar-border-width) solid var(--accent-color);
  position: sticky;
  top: 0;
  align-self: flex-start;
}

.dialog__message--user {
  justify-content: flex-end;
  align-self: flex-end;
}

.dialog__message--user .dialog__avatar {
  order: 2;
  margin-left: 8px;
}

.dialog__message--ghost {
  justify-content: flex-start;
  align-self: flex-start;
}

.dialog__message--ghost .dialog__avatar {
  margin-right: 8px;
}

.dialog__avatar--placeholder {
  background-color: #ccc;
}

.dialog__message-content {
  display: flex;
  flex-direction: column;
  gap: 8px;
  width: 100%;
}

.dialog__message-content--inline {
  flex-direction: row;
  align-items: flex-start;
  gap: 12px;
}

.dialog__message-text {
  margin: 0;
  font-size: 1.7em;
}

.dialog__message-text--emoji {
  font-size: 3.6rem;
  line-height: 1;
}

.dialog__message-content--inline .dialog__message-text {
  flex-shrink: 0;
}

.dialog__message-note {
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--fg, #d6ffe1);
  font-size: 0.95em;
}

.dialog__message-note--inline {
  align-items: flex-start;
  flex: 1;
}

.dialog__message-note--stacked {
  align-self: flex-start;
}

.dialog__message-note-body {
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex: 1;
}

.dialog__message-note-text {
  margin: 0;
  line-height: 1.35;
  word-break: break-word;
}

.dialog__message-note-toggle {
  background: transparent;
  border: 1px solid var(--accent-color);
  border-radius: var(--button-radius);
  width: 32px;
  height: 32px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--fg, #d6ffe1);
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.dialog__message-note-toggle:hover {
  box-shadow: 0 0 12px rgba(102, 255, 140, 0.35);
  transform: translateY(-1px);
}

.dialog__message-note-toggle:focus-visible {
  outline: 2px solid rgba(102, 255, 140, 0.75);
  outline-offset: 2px;
}

.dialog__message-note-toggle-icon {
  font-size: 1.1rem;
  line-height: 1;
}

.dialog__image {
  max-width: 100%;
  display: block;
  cursor: pointer;
}

.dialog__analysis {
  position: relative;
  display: inline-flex;
  border: var(--avatar-border-width) solid var(--accent-color);
  padding: 0;
  border-radius: 0;
  background: rgba(9, 37, 22, 0.35);
  max-width: min(520px, 100%);
  box-shadow: 0 0 18px rgba(12, 35, 21, 0.65);
}

.dialog__analysis-image {
  width: min(520px, 100%);
  min-width: 240px;
  max-width: 100%;
  display: block;
  object-fit: contain;
}

.messenger__post {
  list-style: none;
}

.messenger__post-content {
  margin: 0;
}

@media (max-width: 640px) {
  .dialog__message {
    min-width: 100%;
    max-width: 100%;
  }
}

.dialog__reaction {
  position: absolute;
  left: 12px;
  bottom: 12px;
  transform: none;
  display: inline-flex;
  pointer-events: none;
  z-index: 2;
}

.dialog__analysis .dialog__reaction {
  left: 12px;
  bottom: 12px;
}

.dialog__reaction-trigger {
  pointer-events: auto;
  background: rgba(0, 0, 0, 0.55);
  color: var(--text-color);
  border: none;
  border-radius: 50%;
  width: 54px;
  height: 54px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  cursor: pointer;
  box-shadow: none;
  transition: box-shadow 0.2s ease, transform 0.2s ease, background-color 0.2s ease;
}

.dialog__reaction-trigger:not(:disabled):hover {
  box-shadow: 0 0 16px rgba(102, 255, 140, 0.55);
  transform: translateY(-2px);
  background: rgba(0, 0, 0, 0.7);
}

.dialog__reaction-trigger:disabled {
  cursor: default;
  opacity: 0.6;
}

.dialog__reaction-trigger--filled {
  background: rgba(0, 0, 0, 0.65);
}

.dialog__reaction-trigger--locked {
  cursor: not-allowed;
  opacity: 0.7;
  box-shadow: none;
}

.dialog__message--reaction-locked .dialog__reaction-trigger {
  pointer-events: none;
}

.dialog__reaction-trigger-icon {
  font-size: 1.75rem;
  line-height: 1;
  text-shadow: 0 0 12px rgba(0, 0, 0, 0.5);
}

.dialog__reaction-trigger--pending {
  box-shadow: 0 0 16px rgba(255, 246, 120, 0.7);
  animation: reaction-pulse 1.5s ease-in-out infinite;
}

.dialog__youtube {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.dialog__youtube-thumb {
  position: relative;
  padding: 0;
  margin: 0;
  border: var(--avatar-border-width) solid var(--accent-color);
  border-radius: 8px;
  background: rgba(0, 0, 0, 0.25);
  cursor: pointer;
  overflow: hidden;
  box-shadow: 0 0 14px rgba(12, 35, 21, 0.55);
}

.dialog__youtube-thumb:focus-visible {
  outline: 2px solid rgba(102, 255, 140, 0.75);
  outline-offset: 2px;
}

.dialog__youtube-image {
  display: block;
  width: min(520px, 100%);
  max-width: 100%;
}

.dialog__youtube-play {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 62px;
  height: 62px;
  border-radius: 50%;
  background: rgba(0, 0, 0, 0.6);
  color: var(--accent-color);
  font-size: 1.8rem;
  box-shadow: 0 0 14px rgba(0, 0, 0, 0.55);
}

.dialog__youtube-frame {
  width: min(92vw, 960px);
  height: min(70vh, 540px);
  border: 0;
  border-radius: 12px;
  box-shadow: 0 18px 36px rgba(0, 0, 0, 0.45);
}

.dialog__reaction-trigger--ghost-replay {
  pointer-events: none;
}

.dialog__reaction-trigger-icon--ghost-hidden {
  opacity: 0;
  transform: scale(0.85);
  transition: opacity 0.25s ease, transform 0.25s ease;
}

.panel__ghost-overlay {
  position: absolute;
  top: calc(var(--panel-padding) + 6px);
  left: 50%;
  transform: translate(-50%, -8px);
  padding: 10px 16px;
  background: rgba(0, 25, 5, 0.92);
  border: 1px solid var(--accent-color);
  border-radius: 14px;
  color: var(--text-color);
  font-size: 0.95rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  text-shadow: 0 0 8px rgba(111, 214, 124, 0.7);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s ease, transform 0.25s ease;
  z-index: 2100;
}

.panel__ghost-overlay--visible {
  opacity: 1;
  transform: translate(-50%, 0);
}

.panel__circle--ghost-replay {
  animation: ghost-replay-spin 1.35s linear 1;
  filter: drop-shadow(0 0 10px rgba(102, 255, 140, 0.4));
}

@keyframes ghost-replay-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.panel__sector-emoji--ghost-target {
  animation: ghost-sector-pulse 0.85s ease-in-out infinite;
  text-shadow: 0 0 12px rgba(102, 255, 102, 0.9);
}

.panel__sector-emoji--ghost-scan {
  animation: ghost-sector-scan 0.32s ease-in-out;
  text-shadow: 0 0 10px rgba(102, 255, 140, 0.6);
}

@keyframes ghost-sector-pulse {
  0% {
    transform: scale(1);
    opacity: 0.9;
  }
  50% {
    transform: scale(1.18);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 0.9;
  }
}

@keyframes ghost-sector-scan {
  0% {
    transform: scale(0.95);
    opacity: 0.8;
  }
  50% {
    transform: scale(1.12);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 0.9;
  }
}

.dialog__finale {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  padding: 0.75rem;
  margin-top: 0.5rem;
  border-radius: 12px;
  background-color: rgba(255, 255, 255, 0.04);
}

.dialog__finale-body {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.dialog__finale-title {
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
}

.dialog__finale-text,
.dialog__finale-image-caption {
  margin: 0;
  font-size: 0.9375rem;
  line-height: 1.4;
}

.dialog__finale-button {
  align-self: flex-start;
  padding: 0.5rem 1.25rem;
  border-radius: 999px;
  border: 1px solid currentColor;
  background-color: transparent;
  color: inherit;
  font-weight: 600;
  cursor: pointer;
  transition: background-color 0.2s ease, color 0.2s ease;
}

.dialog__finale-button:hover,
.dialog__finale-button:focus-visible {
  background-color: rgba(255, 255, 255, 0.12);
  outline: none;
}

.dialog__finale-image {
  max-width: 180px;
  border-radius: 10px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

body.inverted .dialog__finale {
  background-color: rgba(0, 0, 0, 0.3);
}

body.inverted .dialog__finale-button:hover,
body.inverted .dialog__finale-button:focus-visible {
  background-color: rgba(0, 0, 0, 0.45);
}

@keyframes reaction-pulse {
  0% {
    box-shadow: 0 0 6px rgba(255, 246, 120, 0.4);
  }
  100% {
    box-shadow: 0 0 16px rgba(255, 246, 120, 0.9);
  }
}

.dialog__message--reveal {
  animation: dialog-overlay-reveal 0.5s ease;
}

@keyframes dialog-overlay-reveal {
  from {
    opacity: 0;
    transform: scale(0.8);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.dialog__empty {
  text-align: center;
  padding: 1rem;
  opacity: 0.7;
}

.dialog__empty--hidden {
  display: none;
}

body.inverted .dialog__message--ghost {
  justify-content: flex-end;
  align-self: flex-end;
}

body.inverted .dialog__message--user {
  justify-content: flex-start;
  align-self: flex-start;
}

    /* Global content container with a maximum width */
      .app__global-content {
        max-width: var(--content-max-width);
      margin: 0 auto;
      padding: 1.5rem;
      height: calc(100vh - var(--chat-panel-height, var(--panel-height)));
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 2rem;
      overflow-y: auto;
    }

      .app__bottom-panel {
        display: flex;
        justify-content: center;
        padding: 0;
        background: transparent;
      }

      .app__controls-panel {
        max-width: var(--content-max-width);
      }

    .app__bottom-panel .panel,
    .app__controls-panel,
    .app__controls-panel.panel--double-frame::before {
      pointer-events: auto;
      border: none;
      box-shadow: none;
      background: transparent;
    }

    .app__controls-panel.panel--double-frame::before {
      display: none;
    }

    .registration-screen {
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .registration-screen__panel {
      width: min(420px, 100%);
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
      align-items: center;
      text-align: center;
    }

    .registration-screen__title {
      font-size: clamp(1.5rem, 2.8vw, 2rem);
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .registration-screen__label {
      font-size: 0.95rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: var(--text-color);
    }

    .registration-screen__input {
      width: 100%;
      padding: 0.85rem 1.1rem;
      background: rgba(0, 21, 1, 0.75);
      border: 1px solid rgba(138, 229, 144, 0.65);
      border-radius: 999px;
      color: #f0fff4;
      font-size: 1rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      text-align: center;
      outline: none;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    .registration-screen__input:focus {
      border-color: rgba(174, 255, 189, 0.9);
      box-shadow: 0 0 18px rgba(138, 229, 144, 0.35);
    }
    /* Global camera container */
    .app__global-camera {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: black;
    }

    .panel {
      position: relative;
      width:  var(--panel-width);
      height: var(--chat-panel-height, var(--panel-height));
      overflow: hidden;
      border: var(--frame-width) solid transparent;
      border-image: linear-gradient(
        to right,
        var(--grad-from),
        var(--grad-mid),
        var(--grad-to)
      ) 1;
      border-radius: 30px;
      /*box-shadow: 0 0 var(--glow-spread) var(--project-glow-color);*/
      z-index: 10;
    }
    .panel--double-frame::before {
      content: "";
      position: absolute;
      inset: calc(var(--frame-width) + var(--frame-gap));
      border: var(--frame-width) solid transparent;
      border-image: linear-gradient(
        to right,
        var(--grad-from),
        var(--grad-mid),
        var(--grad-to)
      ) 1;
      border-radius: 20px;
      /*box-shadow: 0 0 var(--glow-spread) var(--project-glow-color);*/
      pointer-events: none;
    }

    .panel__top-left,
    .panel__top-right {
      position: absolute;
      top: var(--panel-padding);
      width: var(--icon-size);
      height: var(--icon-size);
      z-index: 2000;
    }
    .panel__top-left  { left: var(--panel-padding); }
    .panel__top-right { right: var(--panel-padding); }

    .panel__mask {
      position: absolute;
      top:    calc(var(--frame-width) + var(--circle-offset));
      left:   var(--frame-width);
      right:  var(--frame-width);
      bottom: calc(
                 var(--frame-width)
                 + var(--bottom-area-height)
                 + var(--bottom-panel-vertical-offset)
               );
      overflow: hidden;
      z-index: 5;
    }

    .panel__circle {
      position: relative;
      width:  var(--circle-diameter);
      height: var(--circle-diameter);
      margin: calc(var(--frame-width) + var(--circle-offset)) auto 0;
      /*margin-top: calc(-1 * var(--circle-offset));*/
      border-radius: 50%;
      overflow: hidden;
      /* включаем вращение */
      animation: spin var(--rotation-duration) linear infinite;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }
    .panel__circle:hover {
      animation-play-state: paused;
    }

    .panel__circle--manual {
      animation: none !important;
    }

    .panel--reaction-active {
      z-index: 30;
    }

    .panel__selection-badge {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 96px;
      height: 96px;
      margin: -48px 0 0 -48px;
      border-radius: var(--button-radius);
      border: 2px solid var(--accent-color);
      background: transparent;
      color: var(--text-color);
      font-size: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.2s ease, transform 0.2s ease;
      pointer-events: auto;
      opacity: 1;
      transform: scale(1);
      z-index: 25;
      cursor: pointer;
    }

    .panel__selection-badge-countdown {
      font-weight: 600;
      letter-spacing: 1px;
    }

    .panel__selection-badge--hidden {
      opacity: 0;
      pointer-events: none;
      transform: scale(0.6);
    }

    .panel--reaction-active .panel__selection-badge {
      pointer-events: auto;
    }

    .panel__sector-emoji {
      transition: transform 0.2s ease, filter 0.2s ease;
    }

    .panel__sector-emoji--active {
      transform: scale(1.35);
      filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
    }

    .reaction-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.35);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      z-index: 20;
    }

    .reaction-overlay--visible {
      opacity: 1;
      pointer-events: auto;
    }

    .dialog__message--reaction-active {
      position: relative;
      box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.4);
    }

    .panel--sectors-count-6 .panel__circle {
      --sector-angle: 60deg;
      --base-half:    25%;
      --base-y:       43.301%;
    }
    .panel--sectors-count-12 .panel__circle {
      --sector-angle: 30deg;
      --base-half:    12.94%;
      --base-y:       48.296%;
    }

    .panel__sectors {
      position: absolute;
      inset: 0;
      list-style: none;
    }
    .panel__sector {
      position: absolute;
      inset: 0;
      transform-origin: 50% 50%;
      background: transparent;
      transition: background-color .2s;
      clip-path: polygon(
        50% 50%,
        calc(50% - 2*var(--base-half)) calc(50% - 2*var(--base-y)),
        calc(50% + 2*var(--base-half)) calc(50% - 2*var(--base-y))
      );
      transform: rotate(calc(-180deg + var(--i)*var(--sector-angle)));
      display: flex;
      align-items: flex-start;
      justify-content: center;
      pointer-events: auto;
    }
    .panel__sector:hover {
        background:
          linear-gradient(
            to right,
            var(--grad-from),
            var(--grad-mid),
            var(--grad-to)
          ) border-box;
    }

    .panel__sector-emoji {
      font-size: 1.5rem;
      width: var(--emoji-size);
      height: var(--emoji-size);
      margin-top: 8px;
      /*transform: rotate(calc(180deg - var(--i)*var(--sector-angle)));*/
      pointer-events: none;
    }

    .panel__bottom {
      width: 100%;
      min-height: var(--bottom-area-height);
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border-top: 1px solid var(--accent-color);
    }

    .panel__bottom-inner {
      display: flex;
      align-items: center;
      width: 100%;
      min-height: 100%;
      gap: 10px;
      background: transparent;
      border: none;
      box-shadow: none;
      padding: 0;
    }

    .panel__bottom,
    .panel__bottom-inner,
    .panel__bottom .control-button,
    .panel__bottom .control-select-wrapper,
    .panel__bottom .panel__scroll-button,
    .panel__bottom .panel__bottom-button {
      border-radius: 0;
    }

  .buttons {
    display: flex;
    align-items: stretch;
    gap: 10px;
    flex-wrap: nowrap;
    width: 100%;
    flex: 1 1 100%;
    min-width: 0;
    overflow-x: auto;
    scrollbar-width: none;
    justify-content: flex-start;
  }

    .buttons::-webkit-scrollbar {
      display: none;
    }

  .control-button {
    flex: 1 1 0;
    min-width: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    padding: 10px 12px;
    border: none;
    border-radius: var(--button-radius);
    background: transparent;
    color: var(--text-color);
      font-family: var(--btn-font-family);
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      font-size: 1.2em;
      cursor: pointer;
      transition: transform 0.15s ease, filter 0.2s ease;
      text-decoration: none;
    }

    .control-button:hover,
    .control-button:focus-visible {
      transform: translateY(-1px);
      filter: drop-shadow(0 0 6px rgba(111, 214, 124, 0.35));
      outline: none;
    }

    .control-button__icon {
      font-size: 1.5rem;
      line-height: 1;
    }

    .control-button__label {
      display: inline-flex;
      align-items: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }

  .app__messenger-buttons,
  .app__camera-buttons {
    flex: 1 1 auto;
    min-width: 0;
  }

      .app__ghost-switcher-buttons {
        display: flex;
        align-items: stretch;
        gap: 10px;
        flex: 1 1 0;
        min-width: 0;
        width: auto;
      }

  .control-select-wrapper {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    background: transparent;
    border: none;
    border-radius: var(--button-radius);
    padding: 8px 10px;
    box-shadow: none;
    position: relative;
  }

    .ghost-switcher,
    .language-picker {
      width: 100%;
    }

  .ghost-switcher {
    flex: 1 1 0;
    max-width: none;
    min-width: 0;
  }

    .ghost-switcher::after {
      content: '▾';
      position: absolute;
      right: 10px;
      pointer-events: none;
      color: var(--accent-color);
      font-size: 0.9em;
    }

    .ghost-switcher__icon,
    .language-picker__icon {
      font-size: 1.4rem;
      line-height: 1;
    }

    .ghost-switcher__select,
    .control-select {
      flex: 1;
      background: transparent;
      border: none;
      font-family: var(--btn-font-family);
      color: var(--text-color);
      font-weight: 700;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-size: 1.05rem;
      padding: 6px 24px 6px 8px;
      border-radius: 0;
      appearance: none;
      outline: none;
    }

    .ghost-switcher__select:focus-visible,
    .control-select:focus-visible {
      box-shadow: 0 0 0 1px var(--accent-color);
    }

  .control-select {
    background: transparent;
    min-width: 120px;
    box-shadow: none;
    padding-right: 22px;
    position: relative;
    border: none;
  }

    .language-selector,
    .ghost-switcher__select {
      background: transparent;
      box-shadow: none;
    }

    .panel__scroll-button {
      flex: 0 0 54px;
      height: 54px;
      margin-left: 4px;
      border-radius: var(--button-radius);
      background: transparent;
      border: 1px solid var(--accent-color);
      color: var(--text-color);
      font-size: 1.35rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--accent-color);
      box-shadow: none;
    }

    .panel__scroll-button:hover,
    .panel__scroll-button:focus-visible {
      filter: drop-shadow(0 0 6px rgba(111, 214, 124, 0.35));
      outline: none;
    }

    @media (max-width: 640px) {
      .panel__bottom-inner {
        flex-wrap: wrap;
        align-items: stretch;
      }

      .buttons {
        flex: 1 1 100%;
        min-width: 0;
        justify-content: space-between;
      }

      .app__messenger-buttons,
      .app__camera-buttons,
      .app__ghost-switcher-buttons {
        flex: 1 1 0;
        min-width: 0;
      }

      .control-button {
        flex: 1 1 0;
        padding: 10px 12px;
        gap: 6px;
      }

      .control-button__label {
        display: inline-flex;
      }

      .ghost-switcher {
        flex: 1 1 0;
        min-width: 0;
      }

      .ghost-switcher__select,
      .control-select {
        font-size: 1rem;
        min-width: 0;
      }

      .ghost-switcher__select option,
      .control-select option {
        font-size: 1rem;
      }
    }
    .panel__bottom-button {
      flex: 0 0 60px;
      height: 40px;
      border-radius: var(--button-radius);
      background: transparent;
    }
    .panel__bottom-button--center {
      flex: 1;
      margin: 0 16px;

      /* рамка оставляем без изменений */
      border: var(--frame-width) solid transparent;
      border-image: linear-gradient(
        to right,
        var(--grad-from),
        var(--grad-mid),
        var(--grad-to)
      ) 1;

      /* 1) ставим градиент-фон, который будет «заливать» текст */
      background-image: linear-gradient(
        to right,
        var(--grad-from),
        var(--grad-mid),
        var(--grad-to)
      );

      /* 2) прячем цвет текста и обрезаем фон по контуру букв */
      color: transparent;
      -webkit-background-clip: text;
      background-clip: text;

      /* остальные текстовые стили */
      text-align: center;
      font-family: var(--btn-font-family);
      font-weight: var(--btn-font-weight);
      text-transform: uppercase;
      letter-spacing: var(--btn-letter-spacing);
      font-size: var(--btn-font-size);
      line-height: 1;
    }

    .panel__scroll-button {
      flex: 0 0 40px;
      height: 40px;
      margin-left: 4px;
      border-radius: 0;
      background: transparent;
      color: var(--fg);
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border: var(--frame-width) solid transparent;
      border-image: linear-gradient(
        to right,
        var(--grad-from),
        var(--grad-mid),
        var(--grad-to)
      ) 1;
    }

    .panel__scroll-button--up {}

    .panel__scroll-button--down {}

    .panel__settings-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 44px;
      height: 44px;
      border-radius: var(--button-radius);
      background: transparent;
      border: var(--frame-width) solid transparent;
      border-image: linear-gradient(
        to right,
        var(--grad-from),
        var(--grad-mid),
        var(--grad-to)
      ) 1;
      color: var(--text-color);
      cursor: pointer;
      transition: box-shadow 0.2s ease, transform 0.2s ease;
    }

    .panel__settings-button:hover {
      box-shadow: 0 0 12px rgba(102, 255, 102, 0.7);
      transform: translateY(-1px);
    }

    .panel__settings-icon {
      font-size: 1.4rem;
      line-height: 1;
    }

    /* Highlights camera toggle when a quest requires camera usage */
    .active { box-shadow: 10px 5px 5px red; }

/* --- styling for diary entries (feed) --- */

/* Dropdown menus inside the panel */
.panel__dropdown {
  position: relative;
}

.panel__dropdown-menu {
  display: none;
  position: absolute;
  bottom: 100%;
  right: 0;
  flex-direction: column;
  background: #183524a0;
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 4px;
  z-index: 1000;
}

.panel__dropdown-menu--show {
  display: flex;
}

.panel__dropdown-item {
  background: transparent;
  color: var(--fg);
  border: none;
  padding: 6px 8px;
  text-align: left;
  font-family: var(--btn-font-family);
  font-size: 1rem;
}

.panel__dropdown-item:hover {
  background: rgba(255, 255, 255, 0.1);
}

/* location display animation */
.location-display {
  opacity: 0;
  transition: opacity 0.5s ease-in-out;
}

.location-display--visible {
  opacity: 1;
}\n/* Selfie screen styles */
[data-js="selfie-content-container"] {
  position: absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  z-index:1;
  display:flex;
  align-items:center;
  justify-content:center;
  background: var(--bg-color);
}

[data-js="selfie-content"] {
  position: relative;
}
.camera-view,
[data-js="selfie-preview"] {
  width:100%;
  height:100%;
  object-fit:cover;
}
.record-indicator {
  position:absolute;
  top:1rem;
  right:1rem;
  width:1rem;
  height:1rem;
  border-radius:50%;
  background-color:red;
  opacity:0;
  animation:blink 1s infinite;
}
.detection-status {
  position:absolute;
  top:1rem;
  left:1rem;
  color:#fff;
  font-size:0.9rem;
}

.retry-detection {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 2;
  width: 4rem;
  height: 4rem;
  border: 1px solid var(--accent-color);
  border-radius: var(--button-radius);
  background: transparent;
  color: var(--text-color);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

/* Modifier to keep retry control hidden until explicitly shown */
.retry-detection--hidden {
  display: none;
}
@keyframes blink {
  0%,50% { opacity:1; }
  51%,100% { opacity:0; }
}
.selfie-thumbnail {
  width:100px;
  height:100px;
  object-fit:cover;
  margin-top:0.5rem;
  border:1px solid #ccc;
  border-radius:4px;
  opacity:0;
  transition:opacity .3s ease-in-out;
}
.selfie-thumbnail--visible { opacity:1; }

.is-hidden {
  display: none;
}

.panel--hidden {
  display: none;
}

/* simple overlay reveal animation */
.overlay-reveal {
  animation: reveal 1s ease-in-out;
}

@keyframes reveal {
  from { opacity: 0; }
  to { opacity: 1; }
}

.button--disabled {
  opacity: 0.5;
  pointer-events: none;
}

/* Global modal overlay */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 24px;
  z-index: 2600;
}

.modal__content {
  max-width: 90vw;
  max-height: 90vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal__viewer {
  width: 100%;
  max-width: 1040px;
  max-height: 90vh;
  padding: 18px;
  border-radius: 16px;
  background: radial-gradient(circle at 15% 20%, rgba(120, 255, 167, 0.08), rgba(8, 20, 12, 0.92));
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.45);
  display: flex;
  flex-direction: column;
  gap: 16px;
  overflow: hidden;
}

.modal__media {
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: auto;
}

.modal__viewer--video {
  max-width: 1100px;
}

.modal__media--video {
  overflow: hidden;
}

.modal__image {
  max-width: min(92vw, 1000px);
  max-height: 68vh;
  border-radius: 12px;
  box-shadow: 0 14px 32px rgba(0, 0, 0, 0.5);
  object-fit: contain;
}

.modal__actions {
  display: flex;
  justify-content: center;
  gap: 12px;
}

.modal__button {
  padding: 10px 16px;
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, 0.15);
  background: rgba(12, 30, 18, 0.9);
  color: #f4fff5;
  font-weight: 600;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.modal__button:hover {
  transform: translateY(-1px);
  box-shadow: 0 8px 18px rgba(111, 214, 124, 0.35);
}

.modal__button--primary {
  background: linear-gradient(135deg, rgba(111, 214, 124, 0.95), rgba(56, 145, 78, 0.95));
  color: #0b0f0c;
}
}

.ghost-switch-modal {
  min-width: 280px;
  max-width: 420px;
  padding: 20px;
  border-radius: 12px;
  background: radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.12), rgba(0, 0, 0, 0.6));
  color: #fff;
  box-shadow: 0 16px 30px rgba(0, 0, 0, 0.35);
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.ghost-switch-modal__title {
  margin: 0;
  font-size: 1.3rem;
  letter-spacing: 0.02em;
}

.ghost-switch-modal__message {
  margin: 0;
  line-height: 1.4;
  font-size: 0.95rem;
}

.ghost-switch-modal__actions {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

.ghost-switch-modal__button {
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}

.ghost-switch-modal__button:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
}

.ghost-switch-modal__button--confirm {
  background: linear-gradient(135deg, #6ee7ff, #4f46e5);
  color: #0b1021;
}

.ghost-switch-modal__button--cancel {
  background: rgba(255, 255, 255, 0.12);
  color: #fff;
}

.profile-transfer {
  display: flex;
  flex-direction: column;
  gap: 12px;
  color: #fff;
}

.profile-transfer__title {
  margin: 0;
  font-size: 1.4rem;
}

.profile-transfer__description {
  margin: 0;
  line-height: 1.4;
  font-size: 0.95rem;
}

.profile-transfer__field {
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-size: 0.9rem;
}

.profile-transfer__input {
  padding: 8px;
  border-radius: 4px;
  border: 1px solid rgba(255, 255, 255, 0.4);
  background: rgba(0, 0, 0, 0.2);
  color: #fff;
}

.profile-transfer__actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

.profile-transfer__error {
  min-height: 18px;
  font-size: 0.85rem;
  color: #ff7f7f;
}
